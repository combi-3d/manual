
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Manual of CoMBI">
      
      
        <meta name="author" content="Tajika Y.">
      
      
      <link rel="icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.9">
    
    
      
        <title>Automation - Manual of CoMBI</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.120efc48.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.9647289d.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#automation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Manual of CoMBI" class="md-header__button md-logo" aria-label="Manual of CoMBI" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Manual of CoMBI
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Automation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Manual of CoMBI" class="md-nav__button md-logo" aria-label="Manual of CoMBI" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    Manual of CoMBI
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        Top page
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" data-md-state="indeterminate" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Installation/導入
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Installation/導入" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Installation/導入
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../devices/system/index.html" class="md-nav__link">
        System Overview/概要
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../devices/camera/index.html" class="md-nav__link">
        Imaging devices/カメラなど
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../devices/selfmade/index.html" class="md-nav__link">
        Self-made devices/自作装置
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../devices/computer/index.html" class="md-nav__link">
        Computer and storage/コンピュータとストレージ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../devices/application/index.html" class="md-nav__link">
        Applications/アプリケーション
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" data-md-state="indeterminate" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Instruction/操作
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Instruction/操作" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Instruction/操作
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/frozenblock/index.html" class="md-nav__link">
        Frozen Block
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/paraffinblock/index.html" class="md-nav__link">
        Paraffin Block
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/camerasettings/index.html" class="md-nav__link">
        Camera Settings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/tethering/index.html" class="md-nav__link">
        Tethering (optional)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/combi-u/index.html" class="md-nav__link">
        CoMBI-U (Universal)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/combi-c/index.html" class="md-nav__link">
        CoMBI-C (Cryostat)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/combi-s/index.html" class="md-nav__link">
        CoMBI-S (Sliding, motorized)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/combi-s-m/index.html" class="md-nav__link">
        CoMBI-S (Sliding, manual)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../operation/combi-r/index.html" class="md-nav__link">
        CoMBI-R (Rotary, manual)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" data-md-state="indeterminate" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Image Processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Image Processing" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Image Processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/index.html" class="md-nav__link">
        Overview/画像処理の概要
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rawjpeg/index.html" class="md-nav__link">
        RAW to JPEG conversion/RAW現像
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scale/index.html" class="md-nav__link">
        Resizing and Reducing/画像の縮小
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../registration/index.html" class="md-nav__link">
        Image Registration/ズレ補正
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Automation/自動処理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../3dslicer/index.html" class="md-nav__link">
        3D Reconstruction, 3D slicer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../icy/index.html" class="md-nav__link">
        3D Reconstruction, Icy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../horos/index.html" class="md-nav__link">
        3D Reconstruction, Horos/OsiriX
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../correlation/index.html" class="md-nav__link">
        Correlation of 2D and 3D images/3D像に切片位置を示す
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../EDF/index.html" class="md-nav__link">
        Extended Depth of Field/深度合成
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ilastik/index.html" class="md-nav__link">
        Segmentation by ilastik/セグメンテーション
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../gallery/gallery/index.html" class="md-nav__link">
        Gallery/作品集
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../publication/publication/index.html" class="md-nav__link">
        Publications/論文
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" data-md-state="indeterminate" type="checkbox" id="__nav_7" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Electronics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Electronics" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Electronics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../electronics/ATmega328P/index.html" class="md-nav__link">
        ATmega328P standalone/単体利用
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../electronics/terminal/index.html" class="md-nav__link">
        Crimped terminal/圧着端子
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../electronics/vender/index.html" class="md-nav__link">
        Venders/パーツの入手先
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../electronics/mkdocs/index.html" class="md-nav__link">
        Mkdocs-material/HPづくり
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#imagej-macro-excel-vba" class="md-nav__link">
    ImageJ macro, Excel VBA
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#imagej" class="md-nav__link">
    ImageJ
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#description-of-each-macro" class="md-nav__link">
    Description of each macro
  </a>
  
    <nav class="md-nav" aria-label="Description of each macro">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combi_resizeijm" class="md-nav__link">
    CoMBI_resize.ijm
  </a>
  
    <nav class="md-nav" aria-label="CoMBI_resize.ijm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    Data:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macro-runs" class="md-nav__link">
    Macro runs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combi_imagestabilizer_2xijm" class="md-nav__link">
    CoMBI_ImageStabilizer_2x.ijm
  </a>
  
    <nav class="md-nav" aria-label="CoMBI_ImageStabilizer_2x.ijm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-preparation" class="md-nav__link">
    Data Preparation:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-macro-combi_imagestabilizer_2xijm" class="md-nav__link">
    Run Macro "CoMBI_ImageStabilizer_2x.ijm"
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combi_imagestabilizer_1x1ijm" class="md-nav__link">
    CoMBI_ImageStabilizer_1x1.ijm
  </a>
  
    <nav class="md-nav" aria-label="CoMBI_ImageStabilizer_1x1.ijm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    Preparation:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macro-runs_1" class="md-nav__link">
    Macro runs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is_log_validatorxlsm" class="md-nav__link">
    IS_Log_Validator.xlsm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combi_crop1_isaplier_crop2_copylogijm" class="md-nav__link">
    CoMBI_Crop1_ISAplier_Crop2_CopyLog.ijm
  </a>
  
    <nav class="md-nav" aria-label="CoMBI_Crop1_ISAplier_Crop2_CopyLog.ijm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparation_1" class="md-nav__link">
    Preparation:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macro-runs_2" class="md-nav__link">
    Macro runs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combi_crop1_isaplier_crop2_selectlogijm" class="md-nav__link">
    CoMBI_Crop1_ISAplier_Crop2_SelectLog.ijm
  </a>
  
    <nav class="md-nav" aria-label="CoMBI_Crop1_ISAplier_Crop2_SelectLog.ijm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparation_2" class="md-nav__link">
    Preparation:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macro-runs_3" class="md-nav__link">
    Macro runs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combi_is_applier_copylogijm" class="md-nav__link">
    CoMBI_IS_Applier_CopyLog.ijm
  </a>
  
    <nav class="md-nav" aria-label="CoMBI_IS_Applier_CopyLog.ijm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prepararion" class="md-nav__link">
    Prepararion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macro-runs_4" class="md-nav__link">
    Macro runs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combi_is_applier_selectlogijm" class="md-nav__link">
    CoMBI_IS_Applier_SelectLog.ijm
  </a>
  
    <nav class="md-nav" aria-label="CoMBI_IS_Applier_SelectLog.ijm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparation_3" class="md-nav__link">
    Preparation:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macro-runs_5" class="md-nav__link">
    Macro runs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#combi_crop_invertijm" class="md-nav__link">
    CoMBI_Crop_Invert.ijm
  </a>
  
    <nav class="md-nav" aria-label="CoMBI_Crop_Invert.ijm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#preparation_4" class="md-nav__link">
    Preparation:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#macro-runs_6" class="md-nav__link">
    Macro runs:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="automation">Automation</h1>
<p>(2022.6.24 only description, no image)</p>
<h2 id="introduction">Introduction</h2>
<p>Since 2022.6, serial images can be processed automatically by use of ImageJ macro and Excel VBA. Automatic process includes steps below:</p>
<ul>
<li>Resize, ImageJ /縮小</li>
<li>Image registration, ImageJ and Excel VBA /ズレ補正、補正値の修正</li>
<li>Crop, ImageJ /切り抜き</li>
</ul>
<p>All macro save "work log" containing image information, path, values used, data of processing. This will contribute to improve reproductibity of image processing.</p>
<h2 id="imagej-macro-excel-vba">ImageJ macro, Excel VBA</h2>
<p>Codes are available at <a href="https://github.com/combi-3d/ImageJ">GitHub CoMBI_ImageJ</a>（2022.6).</p>
<table>
<thead>
<tr>
<th>Step</th>
<th>FIles</th>
<th>Priority</th>
<th>Compatibility</th>
</tr>
</thead>
<tbody>
<tr>
<td>Resize</td>
<td>CoMBI_Resize.ijm</td>
<td>Essential</td>
<td></td>
</tr>
<tr>
<td>Image Stabilizer</td>
<td>CoMBI_ImageStabilizer_2x.ijm</td>
<td>Essential</td>
<td></td>
</tr>
<tr>
<td>Image Stabilizer</td>
<td>CoMBI_ImageStabilizer_1x1.ijm</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Image Stabilizer</td>
<td>IS_Log_Validator.xlsm</td>
<td>Essential</td>
<td></td>
</tr>
<tr>
<td>Crop, IS_applier</td>
<td>CoMBI_Crop1_ISAplier_Crop2_CopyLog.ijm</td>
<td>Essential</td>
<td>Intel Mac_FIJI</td>
</tr>
<tr>
<td>Crop, IS_applier</td>
<td>CoMBI_Crop1_ISAplier_Crop2_SelectLog.ijm</td>
<td>Essential</td>
<td>ARM Mac, ImageJ, FIJI</td>
</tr>
<tr>
<td>IS_applier</td>
<td>CoMBI_IS_Applier_CopyLog.ijm</td>
<td></td>
<td>Intel Mac, FIJI</td>
</tr>
<tr>
<td>IS_applier</td>
<td>CoMBI_IS_Applier_SelectLog.ijm</td>
<td></td>
<td>ARM Mac, ImageJ, FIJI</td>
</tr>
<tr>
<td>Crop, Invert</td>
<td>CoMBI_Crop_Invert.ijm</td>
<td>Essential</td>
<td></td>
</tr>
</tbody>
</table>
<p>ImageJ macro files (.ijm) are NOT veified on Win or Linux. Difference of "CopyLog" and "SelectLog" is style for importing csv file. Try "SelectLog" at first. It is more convenient than "CopyLog". </p>
<p>Excel macro (.xlsm) was created by Excel VBA on Mac and verified in Win10. Excel VBA Commands of Mac is fewer than that of Win. Thus, I hope the file work both on Mac and Win.  </p>
<h2 id="imagej">ImageJ</h2>
<ul>
<li>Use ImageJ 1.53p or newer, due to the compatibility of a command for processing serial images. </li>
<li>For Apple silicon mac, use latest ImageJ_ARM (1.53s) or latest FIJI/mac (2.3.0/1.53q)(2022.6).</li>
<li>For Intel mac, use only latest FIJI/mac (2.3.0/1.53q). Do not use ImageJ/Intel mac, bacause it is still 1.53k(2022.6).</li>
<li>Place these ijm files in ImageJ/"plugins" folder (Not "macros" folder), and a shortcut will be found in Menubar&gt;plugins. </li>
<li>Plugins "Image Stabilizer" and "Image Stabilizer Log Applier" are needed. Download from <a href="https://imagej.net/plugins/image-stabilizer">https://imagej.net/plugins/image-stabilizer</a>. For Mac, open "Finder". Find <code>/Application/Fiji.app</code>. Over the icon, <code>Right click</code>, <code>Show packege contents</code>. Go to <code>/plugins</code> put downloaded .class files. Restart ImageJ/FIJI.</li>
</ul>
<h2 id="description-of-each-macro">Description of each macro</h2>
<h3 id="combi_resizeijm">CoMBI_resize.ijm</h3>
<p>Automate <a href="../scale/">Resizing and reducing</a> process.</p>
<h4 id="data">Data:</h4>
<ul>
<li>*"a folder containing serial image" </li>
<li>"a scale image (reference image)", then run the macro.</li>
</ul>
<h4 id="macro-runs">Macro runs:</h4>
<ol>
<li>Select a folder containing serial image.</li>
<li>Calculate the pixel size of the scale image (reference image) or Use the pixel size of the previous experiment.</li>
<li>Plan the resizing process. By default, RGB series of 5μm/pixel, 10μm/pixel, and 20μm/pixel are created. 
    Custom pixel sizes can also be selected. Grayscale series (8-bit, inverted) can be created optionally in addition to RGB series.</li>
<li>Create folders to store the resized images.</li>
<li>Resize the serial images as selected above.</li>
<li>All information (log window) will be saved as a text file, hoping that it will help the researcher to handle the dataset and reproduce the experiment.</li>
</ol>
<h3 id="combi_imagestabilizer_2xijm">CoMBI_ImageStabilizer_2x.ijm</h3>
<p>Automate <a href="../registration/">Image Registration</a> process. Fully automated.</p>
<h4 id="data-preparation">Data Preparation:</h4>
<ul>
<li>"a folder containing serial image".</li>
</ul>
<h4 id="run-macro-combi_imagestabilizer_2xijm">Run Macro "CoMBI_ImageStabilizer_2x.ijm"</h4>
<ol>
<li>Select items to be saved.</li>
<li>Select a folder containing serial image.
      a. Run plugin; Image Registration. From first to last image (Forward).
      b. Save log (essential), and images (optional)
      c. Run plugin; Image Registration. From last to first image (Backward).
      d. Save log (essential), and images (optional)</li>
</ol>
<h3 id="combi_imagestabilizer_1x1ijm">CoMBI_ImageStabilizer_1x1.ijm</h3>
<p>Automate <a href="../registration/">Image Registration</a> process. Step by step.</p>
<h4 id="preparation">Preparation:</h4>
<ul>
<li>"a folder containing serial image"</li>
</ul>
<h4 id="macro-runs_1">Macro runs:</h4>
<ol>
<li>Select a folder containing serial image.</li>
<li>Run plugin; Image Registration. From first to last image (Forward).</li>
<li>[Success Forward] Save images and log, and end macro.</li>
<li>[False Froward] Try again from last to first image (Backward).</li>
<li>[Success Backward] Save images and log, and end macro.</li>
<li>[False Backward] Save log only.</li>
<li>Save work log.</li>
</ol>
<h3 id="is_log_validatorxlsm">IS_Log_Validator.xlsm</h3>
<p>Automate middle part of <a href="../registration/">Image Registration</a> process; Correct log file.
When open this file by Excel app, the app will ask "Activate macro", may ask "permit foler access".
1. Sheet1: Import Log_Forward
1. Sheet2: Import Log_Backward
1. Sheet3: (Just take a look values.)
1. Sheet4: Create validated Log files.
1. Sheet5: (Macro uses here during creation of log files.)</p>
<h3 id="combi_crop1_isaplier_crop2_copylogijm">CoMBI_Crop1_ISAplier_Crop2_CopyLog.ijm</h3>
<p>Automate last part of <a href="../registration/">Image Registration</a> process; Apply corrected log file, and Crop also.</p>
<h4 id="preparation_1">Preparation:</h4>
<ul>
<li>Log file</li>
<li>serial images</li>
<li>Copy log file values using TextEdit.app (Mac) etc.</li>
</ul>
<h4 id="macro-runs_2">Macro runs:</h4>
<ol>
<li>Import log values on the clipboard.</li>
<li>Select serial images and open.</li>
<li>Crop by a rectangle drawn manually.</li>
<li>Save crop values (x, y, Height, Width) in a work log, to reuse later for processing larger image series.</li>
<li>Image Stabilizer Log Applier</li>
<li>Crop again</li>
<li>Images to be saved: [default]<ol>
<li>_Crop1          [false]</li>
<li>_Crop1_IS       [false]</li>
<li>_Crop1_IS_Crop2 [true]</li>
</ol>
</li>
</ol>
<h3 id="combi_crop1_isaplier_crop2_selectlogijm">CoMBI_Crop1_ISAplier_Crop2_SelectLog.ijm</h3>
<p>Automate last part of <a href="../registration/">Image Registration</a> process; Apply corrected log file, and Crop also.</p>
<h4 id="preparation_2">Preparation:</h4>
<ul>
<li>Log file</li>
<li>serial images</li>
</ul>
<h4 id="macro-runs_3">Macro runs:</h4>
<ol>
<li>Select log file and serial images, and open.</li>
<li>Crop by a rectangle drawn manually.</li>
<li>Save crop values (x, y, Height, Width) in a work log, to reuse later for processing larger image series.</li>
<li>Image Stabilizer Log Applier</li>
<li>Crop again</li>
<li>Images to be saved: [default]<ol>
<li>_Crop1          [false]</li>
<li>_Crop1_IS       [false]</li>
<li>_Crop1_IS_Crop2 [true]</li>
</ol>
</li>
</ol>
<h3 id="combi_is_applier_copylogijm">CoMBI_IS_Applier_CopyLog.ijm</h3>
<p>Automate last part of <a href="../registration/">Image Registration</a> process; Only apply corrected log file.</p>
<h4 id="prepararion">Prepararion</h4>
<ul>
<li>Open validated log text file with TextEdit.app (Mac).
Select all (Command+a), Copy (Command+c) to keep value system clipboard.</li>
<li>"a folder containing serial image"</li>
</ul>
<h4 id="macro-runs_4">Macro runs:</h4>
<ol>
<li>Then, Run automatically</li>
<li>File&gt;New&gt;System clipboard. to reveal values in FIJI/ImageJ</li>
<li>Open sequence images on system memory. NOT virtual stack, since IS supports virtual stack "partially" in current ImageJ.</li>
<li>Run plugin: Image_Stabilizer_Log_Applier</li>
<li>Save as Image Sequence in new folder with _IS_Validated</li>
<li>Close images and log.</li>
</ol>
<h3 id="combi_is_applier_selectlogijm">CoMBI_IS_Applier_SelectLog.ijm</h3>
<p>Automate last part of <a href="../registration/">Image Registration</a> process; Only apply corrected log file.</p>
<h4 id="preparation_3">Preparation:</h4>
<ul>
<li>Log file</li>
<li>Serial images</li>
</ul>
<h4 id="macro-runs_5">Macro runs:</h4>
<ol>
<li>Select a Log file</li>
<li>Select a folder containing serial image</li>
<li>Open sequence images on system memory. NOT virtual stack, since IS supports virtual stack "partially" in current ImageJ.</li>
<li>Run plugin: Image_Stabilizer_Log_Applier</li>
<li>Save as Image Sequence in new folder with _IS_Validated</li>
<li>Close images and log.</li>
</ol>
<h3 id="combi_crop_invertijm">CoMBI_Crop_Invert.ijm</h3>
<p>Automate croping serial images, and/or converting to 8-bit inverted series. 8-bit inverted images will be used for volume rendering. </p>
<h4 id="preparation_4">Preparation:</h4>
<ul>
<li>Serial images</li>
</ul>
<h4 id="macro-runs_6">Macro runs:</h4>
<ol>
<li>Select a folder containing serial image</li>
<li>Open sequence images as virtual stack</li>
<li>Crop by a drawn rectangle.</li>
<li>Save as Image Sequence in new folder, and work log.</li>
</ol>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2021 Tajika Y, CC BY-NC
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6e54b5cd.min.js"></script>
      
    
  </body>
</html>